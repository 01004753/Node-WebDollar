import InterfaceBlockchainBlock from "../../../common/blockchain/interface-blockchain/blocks/Interface-Blockchain-Block";

var assert = require('assert')

import PPoWBlockchain from 'common/blockchain/ppow-blockchain/blockchain/PPoW-Blockchain'
import PPoWBlockchainBlock from 'common/blockchain/ppow-blockchain/blocks/PPoW-Blockchain-Block'
import consts from 'consts/const_global'

describe('test PPoW-Blockchain interlink data structure', () => {

    let blockchain = null;
    let response = null;

    it('test blockchain ppow interlink', async () => {

        blockchain = new PPoWBlockchain();

        //values are optained from mining simulation :)
        let input = [
{"hash":"000a6c14d6b68a3d4cace949d6be876c3dc223543ee5c92bb49b19bffbf5405a","hashPrev":"7bb3e84e6892c7e76be2beedb94a1035b7f095d50b5462806b92be0cbccd31fa","nonce"
:190,"difficultyTarget":"3071874474137481965796476487975378212998176008212521104625418275595029731696431"},
{"hash":"12651320fc8530b0aa14861c3e3698de929fc7f12b08feb5989356b471b247be","hashPrev":"000a6c14d6b68a3d4cace949d6be876c3dc223543ee5c92bb49b19bffbf5405a","nonce"
:16,"difficultyTarget":"3073374412845556908162588048760522440641241523841531124696036155612410117307610"},
{"hash":"02fac6f7b35e5c619a00d06befdc77288eef8979d3902e9a3baf6378e95afe32","hashPrev":"12651320fc8530b0aa14861c3e3698de929fc7f12b08feb5989356b471b247be","nonce"
:1,"difficultyTarget":"3074875083945579152746651812456206289489210880054344372315516642016517739435201"},
{"hash":"0b8664ea76d1d743e17e2fcf360414a148bd3312e55f4b2abbef7655433ac2d7","hashPrev":"02fac6f7b35e5c619a00d06befdc77288eef8979d3902e9a3baf6378e95afe32","nonce"
:8,"difficultyTarget":"3076376487795161955067328888536507171466500533804370907653561327876877367237659"},
{"hash":"136335e189b97b83f8a232611e8effd2bf689f418ef42742f8c1cfafb5512de3","hashPrev":"0b8664ea76d1d743e17e2fcf360414a148bd3312e55f4b2abbef7655433ac2d7","nonce"
:14,"difficultyTarget":"3077878624752093186490701607720362887858818161018142573135814043369004748764630"},
{"hash":"179e811e9137a0a4396afe69b0b83e457990a4da0eebf1c094de87e2d9fb88bf","hashPrev":"136335e189b97b83f8a232611e8effd2bf689f418ef42742f8c1cfafb5512de3","nonce"
:44,"difficultyTarget":"3079381495174335419491917770614757596300155474573327213064103015069868520614612"},
{"hash":"19d2c6f0f833e0c9cc36c0ab3f02e69517acf1e527a2cdac9689a93efe3f5e19","hashPrev":"179e811e9137a0a4396afe69b0b83e457990a4da0eebf1c094de87e2d9fb88bf","nonce"
:12,"difficultyTarget":"3080885099420026012958466558588690583407723909863646220492356971620195604853193"},
{"hash":"095c7ee7ac0696486686981e6d13e63d65c952c9ddbd167eb78d1e2596e2a4d5","hashPrev":"19d2c6f0f833e0c9cc36c0ab3f02e69517acf1e527a2cdac9689a93efe3f5e19","nonce"
:0,"difficultyTarget":"3082389437847477197535106434838001467481653462554009328998456755297744528488375"},
{"hash":"162684ff5a404963f72145a6120f4511a93d904f709fe422e94034a5ea303d21","hashPrev":"095c7ee7ac0696486686981e6d13e63d65c952c9ddbd167eb78d1e2596e2a4d5","nonce"
:0,"difficultyTarget":"3083894510815176161010465373526887210385697238658772028866131783010292255308925"},
{"hash":"172a427ec1f798be5092b5dea309839124500d4342da4dbdc7d685785aa2d89c","hashPrev":"162684ff5a404963f72145a6120f4511a93d904f709fe422e94034a5ea303d21","nonce"
:9,"difficultyTarget":"3085400318681785133745333764822554635781393379888585882395851573919965249574212"},
{"hash":"16c905f38080db7cd18aae53e9e73cc25369c9ed8218fbb488ee2f93097df3cc","hashPrev":"172a427ec1f798be5092b5dea309839124500d4342da4dbdc7d685785aa2d89c","nonce"
:2,"difficultyTarget":"3086906861806141474142670353574909398787146013374859605971240173321293357606230"},
{"hash":"053f0542c5a0f69212d94e034144f89b0d9f2b96e77e100bf60f3502f158832d","hashPrev":"16c905f38080db7cd18aae53e9e73cc25369c9ed8218fbb488ee2f93097df3cc","nonce"
:3,"difficultyTarget":"3088414140547257754159341579333490897517022549514202799138218317937172895378498"},
{"hash":"1435f12aa4ae9ec03a59d7dc5a5cbf2fc72cdb5d2517eb30fcddc2a12e315a3e","hashPrev":"053f0542c5a0f69212d94e034144f89b0d9f2b96e77e100bf60f3502f158832d","nonce"
:19,"difficultyTarget":"3089922155264321844859614695339024828619325783180957780973735026100228155581319"},
{"hash":"0697dfa32367103552972c49d39b34423dc9494f4d150998ea47cff3b584b7d6","hashPrev":"1435f12aa4ae9ec03a59d7dc5a5cbf2fc72cdb5d2517eb30fcddc2a12e315a3e","nonce"
:2,"difficultyTarget":"3091430906316697002010425054076983336836425063348526608015226107655941157610411"},
{"hash":"071c544e4d4e88b7d74b3a43b4314757a27b1a39b8aebaa2f5212bb5e136434d","hashPrev":"0697dfa32367103552972c49d39b34423dc9494f4d150998ea47cff3b584b7d6","nonce"
:0,"difficultyTarget":"3092940394063921951718437956935419363856364724023989755773046042278820035128775"},
{"hash":"07551e8357f70b07dfd58e9dcd708c0d3e3b7b53c12914814c574c66cefd0a34","hashPrev":"071c544e4d4e88b7d74b3a43b4314757a27b1a39b8aebaa2f5212bb5e136434d","nonce"
:1,"difficultyTarget":"3094450618865710976108925475469079236592622714611892094520982099916651490224052"},
{"hash":"05df1ea0925deb8577cc6625f141e74ff8a0311a354bb206fa98211d77430a1b","hashPrev":"07551e8357f70b07dfd58e9dcd708c0d3e3b7b53c12914814c574c66cefd0a34","nonce"
:3,"difficultyTarget":"3095961581081953999046478661736398122938615206171761182457759923207626417709512"},
{"hash":"075a1a178a7a5d0f24c54e76fb2a21b6987cadb6f753da814775426472375978","hashPrev":"05df1ea0925deb8577cc6625f141e74ff8a0311a354bb206fa98211d77430a1b","nonce"
:2,"difficultyTarget":"3097473281072716671897575575145449098584581326877899737722631876295130141546284"},
{"hash":"0418f5d88c21dbacd2504f5215e025a306e57104cd191d7c3070e093a522d8d8","hashPrev":"075a1a178a7a5d0f24c54e76fb2a21b6987cadb6f753da814775426472375978","nonce"
:5,"difficultyTarget":"3098985719198240459335025563219250587402249579478914337203941755140977373060710"},
{"hash":"08a996fa3436456c4397d0156644dda45f1745170129ae1854b8343d9e41511c","hashPrev":"0418f5d88c21dbacd2504f5215e025a306e57104cd191d7c3070e093a522d8d8","nonce"
:6,"difficultyTarget":"3100498895818942725184310243670041237103129584156394275845154617326104803418649"},
{"hash":"09b734a18f3c55e9bae9de74e0fdbae485943785f369a90c1e94ab9ea643e73b","hashPrev":"08a996fa3436456c4397d0156644dda45f1745170129ae1854b8343d9e41511c","nonce"
:0,"difficultyTarget":"3102012811295416818311841645156208249425933846648658140237657134229096065529693"},
{"hash":"140432ae5afacd5e51af14a4319e416352e17e9cbd6a36ab0c4df2737520c7e2","hashPrev":"09b734a18f3c55e9bae9de74e0fdbae485943785f369a90c1e94ab9ea643e73b","nonce"
:15,"difficultyTarget":"3103527465988432158555157974084507179235223853409717055345195052751668866342939"}];


        for (let i = 0; i < input.length; ++i) {
            let block = new PPoWBlockchainBlock(blockchain, 1, new Buffer(input[i].hash, 'hex'), new Buffer(input[i].hashPrev, 'hex'), undefined, input[i].nonce, undefined, i, blockchain.db);
            block.difficultyTarget = input[i].difficultyTarget;
            blockchain.includeBlockchainBlock(block, false, false, false);
        }

        //check if links point correctly
        /*for (let i = 0; i < blockchain.blocks.length; ++i){
            let block = blockchain.blocks[i];
            console.log('B.height=', block.height, block.interlink.length);
            for (let j = 0; j < block.interlink.length; ++j){
                let link = block.interlink[i];
                console.log('height=', link.height);
                console.log('blockId=', link.blockId);
            }
        }*/

    });

});
